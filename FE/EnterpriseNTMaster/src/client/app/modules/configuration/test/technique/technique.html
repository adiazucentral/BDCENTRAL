<style type="text/css">
  .has-feedback .form-control {
    padding-right: 16.5px;
    overflow-y: scroll !important;
  }

</style>
<loadpage view="vm.loadingdata"></loadpage>
<modalreport openmodal="vm.open"></modalreport>
<modalerror openerrormodal="vm.ShowPopupError" detailerror="vm.Error"></modalerror>
<section class="row general-container">
  <div class="panel panel-primary panel-principal">
    <div class="panel-heading row">
      <div class="col-md-4 text-left">
        <strong class="panel-title text-left title-bar">{{'0045' | translate | uppercase}}</strong>
      </div>
      <div class="col-md-8 text-right" style="padding-top: 5px;">
        <strong ng-bind="vm.usuario" class="text-right"></strong>
        <span class="question-style glyphicon glyphicon-question-sign" data-toggle="tooltip" data-placement="bottom"
          title="Ctrl + B"
          onclick="javascript:window.open('/enterprise_nt_help/index.htm?page=enterprise_nt/configuration/technique/Techniques.htm','','width=1100,height=600,left=50,top=50,toolbar=yes');"></span>
      </div>
    </div>
    <div class="panel-body general-container panel-padding panel-scroll contentscroll">
      <div class="col-md-5 panel-padding" style="height: 100%">
        <div class="panel-list">
          <div class="panel panel-primary general-container">
            <div class="panel-body general-container">
              <div>
                <div class="input-group right-bar">
                  <input data-ng-model="vm.search" class="form-control" type="text"
                    placeholder="{{'0015' | translate}}">
                  <div class="input-group-addon">
                    <i class="glyphicon glyphicon-search"></i>
                  </div>
                </div>
                <div class="number-bage">
                  <span style="margin-top:10px" class="badge" data-ng-bind="vm.filtered.length"></span>
                </div>
              </div>
              <table class="table table-list table-hover ">
                <thead>
                  <tr>
                    <th class="col-md-3">
                      <a
                        ng-click="$event.stopPropagation(); vm.sortType =  vm.code; vm.sortReverse = !vm.sortReverse; $event.stopPropagation() ">
                        <i ng-if="!vm.sortReverse && vm.sortType != vm.code"
                          class="glyphicon glyphicon-sort-by-alphabet"></i>
                        <i ng-if="vm.sortReverse && vm.sortType != vm.code"
                          class="glyphicon glyphicon-sort-by-alphabet-alt"></i>
                        <i ng-if="vm.sortType == vm.code && !vm.sortReverse "
                          class="glyphicon glyphicon-triangle-bottom"></i>
                        <i ng-if="vm.sortType == vm.code && vm.sortReverse"
                          class="glyphicon glyphicon-triangle-top"></i>
                        <span ng-show="vm.sortType == vm.code && !vm.sortReverse"></span>
                        <span ng-show="vm.sortType == vm.code && vm.sortReverse"></span>
                      </a>{{'0018' | translate}}
                    </th>
                    <th class="col-md-8">
                      <a
                        ng-click="$event.stopPropagation(); vm.sortType =  vm.name; vm.sortReverse = !vm.sortReverse; $event.stopPropagation() ">
                        <i ng-if="!vm.sortReverse && vm.sortType != vm.name"
                          class="glyphicon glyphicon-sort-by-alphabet"></i>
                        <i ng-if="vm.sortReverse && vm.sortType != vm.name"
                          class="glyphicon glyphicon-sort-by-alphabet-alt"></i>
                        <i ng-if="vm.sortType == vm.name && !vm.sortReverse "
                          class="glyphicon glyphicon-triangle-bottom"></i>
                        <i ng-if="vm.sortType == vm.name && vm.sortReverse"
                          class="glyphicon glyphicon-triangle-top"></i>
                        <span ng-show="vm.sortType == vm.name && !vm.sortReverse"></span>
                        <span ng-show="vm.sortType == vm.name && vm.sortReverse"></span>
                      </a> {{'0044' | translate}}
                    </th>
                    <th class="col-md-1" style="white-space: nowrap">
                      <a
                        ng-click="$event.stopPropagation(); vm.sortType =  vm.state; vm.sortReverse = !vm.sortReverse; $event.stopPropagation() ">
                        <i ng-if="!vm.sortReverse && vm.sortType != vm.state"
                          class="glyphicon glyphicon-sort-by-alphabet"></i>
                        <i ng-if="vm.sortReverse && vm.sortType != vm.state"
                          class="glyphicon glyphicon-sort-by-alphabet-alt"></i>
                        <i ng-if="vm.sortType == vm.state && !vm.sortReverse "
                          class="glyphicon glyphicon-triangle-bottom"></i>
                        <i ng-if="vm.sortType == vm.state && vm.sortReverse"
                          class="glyphicon glyphicon-triangle-top"></i>
                        <span ng-show="vm.sortType == vm.state && !vm.sortReverse"></span>
                        <span ng-show="vm.sortType == vm.state && vm.sortReverse"></span>
                      </a>{{'0014' | translate}}
                    </th>
                  </tr>
                </thead>
                <tbody class="tbody-list contentscroll" data-scroll-to-top='vm.filtered.length'>
                  <tr class="row-list"
                    data-ng-repeat="Technique in vm.filtered =((vm.dataTechnique | filter: vm.search) | orderBy:vm.sortType:vm.sortReverse)"
                    data-ng-click="vm.getTechniqueId(Technique.id, $index, TechniqueForm)"
                    ng-class="{info: Technique.id == vm.selected, danger: Technique.state == 0 }">
                    <td class="col-md-3" data-ng-bind="Technique.code"></td>
                    <td class="col-md-8" ng-bind-html="Technique.name | trust"></td>
                    <td class="col-md-1 text-center">
                      <i ng-if="Technique.state == true" class="glyphicon glyphicon-ok green"></i>
                      <i ng-if="Technique.state == false" class="glyphicon glyphicon-ban-circle red">
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-7 panel-padding" style="height: 100%">
        <div class="panel-list">
          <div class="panel panel-primary general-container">
            <div class="panel-body general-container panel-padding panel-scroll contentscroll"
              style="height: calc(100% - 55px)">
              <form name="TechniqueForm" id="TechniqueForm" class="form-horizontal panel-body ">
                <div class="form-group">
                  <div class="col-md-12"></div>
                </div>
                <div class="form-group form-group-sm has-feedback"
                  ng-class="{'has-error': TechniqueForm.code.$invalid && TechniqueForm.code.$touched||vm.codeRepeat }">
                  <label class="col-md-2 text-right">{{'0018' | translate}}:</label>
                  <div class="col-md-3">
                    <input class="form-control" maxlength="15" data-ng-model="vm.techniqueDetail.code"
                      ng-required="true" ng-disabled="vm.isDisabled" name="code" id="code" class="form-control"
                      type="text" ng-focus="vm.codeRepeat = false">
                    <span ng-if="TechniqueForm.code.$invalid && TechniqueForm.code.$touched || vm.codeRepeat"
                      class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span>
                    <span ng-if="TechniqueForm.code.$invalid && TechniqueForm.code.$touched"
                      class="help-block ">{{'0016' | translate}}</span>
                    <span ng-if="vm.codeRepeat" class="help-block">{{'0038' | translate}}</span>
                  </div>
                </div>
                <div class="form-group form-group-sm has-feedback"
                  ng-class="{'has-error': TechniqueForm.name.$invalid && TechniqueForm.name.$touched }">
                  <label class="col-sm-2 text-right">{{'0044' | translate}}:</label>
                  <div class="col-sm-9 contentscroll" style="overflow-x: auto;">
                    <div style="width: 20cm; border: 1px solid #ddd; border-radius: 4px; padding: 3px">
                      <wysiwyg textarea-id="name" charset="utf-8" maxlength="2555" textarea-class="form-control"
                        textarea-height="150px" textarea-name="name" textarea-required="true"
                        ng-model="vm.techniqueDetail.name" disabled="vm.isDisabled" enable-bootstrap-title="true"
                        textarea-menu="vm.customMenu" ng-keyup="vm.keyPressTextarea($event)"></wysiwyg>
                    </div>
                    <span ng-if="TechniqueForm.name.$invalid && TechniqueForm.name.$touched"
                      class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span>
                    <span
                      ng-if="TechniqueForm.name.$invalid && TechniqueForm.name.$touched && vm.techniqueDetail.name.length === 0"
                      class="help-block ">{{'0016' | translate}}</span>
                    <span
                      ng-if="TechniqueForm.name.$invalid && TechniqueForm.name.$touched && vm.techniqueDetail.name.length !== 0"
                      class="help-block ">{{'0989' | translate}}</span>
                  </div>
                </div>
                <div class="form-group form-group-sm">
                  <label class="col-md-2 text-right">{{'0014' | translate}}:</label>
                  <div class="col-md-10">
                    <toggle ng-model="vm.techniqueDetail.state" on="{{'0068' | translate}}" off="{{'0492' | translate}}"
                      ng-disabled="vm.isDisabledState" size="btn-sm" ng-change="vm.changeState()"></toggle>
                  </div>
                </div>
              </form>
              <modalstate openstatemodal="vm.ShowPopupState" detailstate="vm.techniqueDetail.state">
              </modalstate>
            </div>
            <div class="panel-footer general-container">
              <button type="button" class=" btn btn-success button-list" ng-click="vm.NewTechnique(TechniqueForm)"
                ng-disabled="vm.isDisabledAdd">
                <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
                {{'0005' | translate}}
              </button>
              <button type="button" class="btn btn-warning button-list" ng-click="vm.EditTechnique()"
                ng-disabled="vm.isDisabledEdit">
                <span class=" glyphicon glyphicon-pencil" aria-hidden="true"></span>{{'0006' | translate}}
              </button>
              <button type="button" class="btn btn-primary button-list" ng-click="vm.saveTechnique(TechniqueForm)"
                ng-disabled="!TechniqueForm.$valid || vm.isDisabledSave">
                <span class="glyphicon glyphicon-floppy-disk" aria-hidden="true"></span>{{'0007' | translate}}
              </button>
              <button type="button" class="btn btn-info  button-list" ng-click="vm.cancelTechnique(TechniqueForm)"
                ng-disabled="vm.isDisabledCancel">
                <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>{{'0008' | translate}}
              </button>
              <button type="button" class="btn btn-violet button-list" ng-click="vm.generateFile()"
                ng-disabled="vm.isDisabledPrint">
                <span class="glyphicon glyphicon-print" aria-hidden="true"></span>{{'0009' | translate}}
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
