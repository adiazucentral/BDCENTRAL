<style type="text/css">
  #container {
    overflow: auto;
    height: 90%;
  }

  body {
    padding: 0px;
  }
</style>

<modalerror detailerror="vm.Error" openerrormodal="vm.ShowPopupError">
</modalerror>
<loadpage view="vm.active">
</loadpage>
<modalreport openmodal="vm.open"></modalreport>
<section class="general-container">
  <div class="row general-container">
    <div class="panel panel-primary panel-principal">
      <div class="panel-heading row">
        <div class=" col-md-4 panel-title">
          <strong class="panel-title text-left title-bar">
            {{'0314' | translate |uppercase}}
          </strong>
        </div>
        <div class=" col-md-8 text-right" style="padding-top: 5px">
          <strong ng-bind="vm.usuario">
          </strong>
          <span class="question-style glyphicon glyphicon-question-sign" data-placement="bottom" data-toggle="tooltip"
            onclick="javascript:window.open('/enterprise_nt_help/index.htm?page=enterprise_nt/configuration/microorganism/microorganism.htm','','width=1100,height=600,left=50,top=50,toolbar=yes');"
            title="Ctrl + B">
          </span>
        </div>
      </div>
      <div class="panel-body general-container panel-padding panel-scroll contentscroll">
        <div class="col-lg-5 col-md-5 col-sm-12 col-xs-12 panel-padding" style="height: 100%">
          <div class="panel-list">
            <div class="panel panel-primary general-container">
              <div class="panel-body general-container">
                <div style="height: 50px">
                  <div class="input-group right-bar">
                    <input class="form-control" data-ng-model="vm.search" placeholder="{{'0015' | translate}}"
                      type="text">
                    <div class="input-group-addon">
                      <i class="glyphicon glyphicon-search">
                      </i>
                    </div>
                  </div>
                  <div class="number-bage">
                    <span class="badge" data-ng-bind="vm.filtered.length" style="margin-top:10px">
                    </span>
                  </div>
                </div>
                <table class="table table-list">
                  <thead>
                    <tr>
                      <th class="col-md-10">
                        <a
                          ng-click="$event.stopPropagation(); vm.sortType =  vm.name; vm.sortReverse = !vm.sortReverse; $event.stopPropagation() ">
                          <i ng-if="!vm.sortReverse && vm.sortType != vm.name"
                            class="glyphicon glyphicon-sort-by-alphabet"></i>
                          <i ng-if="vm.sortReverse && vm.sortType != vm.name"
                            class="glyphicon glyphicon-sort-by-alphabet-alt"></i>
                          <i ng-if="vm.sortType == vm.name && !vm.sortReverse "
                            class="glyphicon glyphicon-triangle-bottom"></i>
                          <i ng-if="vm.sortType == vm.name && vm.sortReverse"
                            class="glyphicon glyphicon-triangle-top"></i>
                          <span ng-show="vm.sortType == vm.name && !vm.sortReverse"></span>
                          <span ng-show="vm.sortType == vm.name && vm.sortReverse"></span>
                        </a>
                        {{'0314' | translate}}
                      </th>
                      <th class="col-md-2">
                        <a
                          ng-click="$event.stopPropagation(); vm.sortType =  vm.state; vm.sortReverse = !vm.sortReverse; $event.stopPropagation() ">
                          <i ng-if="!vm.sortReverse && vm.sortType != vm.state"
                            class="glyphicon glyphicon-sort-by-alphabet"></i>
                          <i ng-if="vm.sortReverse && vm.sortType != vm.state"
                            class="glyphicon glyphicon-sort-by-alphabet-alt"></i>
                          <i ng-if="vm.sortType == vm.state && !vm.sortReverse "
                            class="glyphicon glyphicon-triangle-bottom"></i>
                          <i ng-if="vm.sortType == vm.state && vm.sortReverse"
                            class="glyphicon glyphicon-triangle-top"></i>
                          <span ng-show="vm.sortType == vm.state && !vm.sortReverse"></span>
                          <span ng-show="vm.sortType == vm.state && vm.sortReverse"></span>
                        </a>
                        {{'0014' | translate}}
                      </th>
                    </tr>
                  </thead>
                  <tbody vs-repeat class="tbody-list contentscroll" data-scroll-to-top='vm.filtered.length'
                    style="height: calc(100% - 15rem);">
                    <tr class="row-list" data-ng-click="vm.getId(microorganism.id,$index,vm.Form)"
                      data-ng-repeat="microorganism in vm.filtered = ((vm.data | filter: vm.search )| orderBy:vm.sortType:vm.sortReverse)"
                      ng-class="{info: microorganism.id == vm.selected , danger: microorganism.state == 0 }">
                      <td class="col-md-10" data-ng-bind="microorganism.name"></td>
                      <td class="col-md-2 text-center">
                        <i class="glyphicon glyphicon-ok green" ng-if="microorganism.state == true">
                        </i>
                        <i class="glyphicon glyphicon-ban-circle red" ng-if="microorganism.state == false">
                        </i>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
        <div class="col-lg-7 col-md-7 col-sm-12 col-xs-12 panel-padding" style="height: 100%">
          <div class="panel-list">
            <div class="panel panel-primary general-container">
              <div class="panel-body panel-form contentscroll" style="overflow:auto">

                <div class="Scrollspymaster" style="height: 100%; overflow:hidden;position: relative;">

                  <nav class="nav navscrollspy" du-scroll-container="container"
                    style=" border-radius: 0px;min-height: 33px">
                    <ul>
                      <li style="width: 50%; font-size: 1em">
                        <a du-scrollspy="" du-smooth-scroll="" href="#section-1" style="padding: 2px 5%; width: 100%">
                          <span style="font-size: 24px;">
                            â‘ 
                          </span>
                          <span>
                            {{'0995' | translate}}
                          </span>
                        </a>
                      </li>
                      <li style="width: 49%; font-size: 1em">
                        <a du-scrollspy="" du-smooth-scroll="" href="#section-2" style="padding: 2px 5%; width: 100%">
                          <span style="font-size: 24px;">
                            â‘¡
                          </span>
                          <span>
                            {{'0317' | translate}} - {{'0288' | translate}}
                          </span>
                        </a>
                      </li>
                    </ul>
                  </nav>

                  <div du-scroll-container="" id="container" class="contentscroll">
                    <section id="section-1" style="padding: 5px 5px;height: 100%;">
                      <form class="form-horizontal panel-body" id="vm.Form" name="vm.Form">
                        <div class="form-group form-group-sm has-feedback"
                          ng-class="{'has-error': vm.Form.name.$invalid && vm.Form.name.$touched||vm.Repeat }">
                          <label class="col-md-3 text-right">
                            {{'0314' | translate}}:
                          </label>
                          <div class="col-md-8">
                            <input class="form-control" data-ng-model="vm.Detail.name" id="name" maxlength="60" name="name"
                              ng-disabled="vm.isDisabled" ng-focus="vm.Repeat = false" ng-required="true" type="text">
                            <span aria-hidden="true" class="glyphicon glyphicon-remove form-control-feedback"
                              ng-if="vm.Form.name.$invalid && vm.Form.name.$touched ||vm.Repeat">
                            </span>
                            <span class="help-block " ng-if="vm.Form.name.$invalid && vm.Form.name.$touched">
                              {{'0016' | translate}}
                            </span>
                            <span class="help-block " ng-if="vm.Repeat">
                              {{'0038' | translate}}
                            </span>
                          </div>
                        </div>

                        <!--Antibiograma-->
                        <div class="form-group form-group-sm" ng-class="{'has-error':vm.Form.sensitivity.$invalid && vm.Form.sensitivity.$touched}">
                          <div class="col-sm-3 text-right">
                            <label>{{'0317' | translate}}:</label>
                          </div>
                          <div class="col-md-8">
                            <select charset="utf-8" ng-options="obj.id as obj.name for obj in vm.listSensitivity track by obj.id" name="sensitivity" id="sensitivity" data-ng-model="vm.Detail.sensitivity" ng-required="true" class="form-control" ng-disabled="vm.isDisabled"></select>
                            <span ng-if="vm.Form.sensitivity.$invalid && vm.Form.sensitivity.$touched" class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true" style="margin-right: -10px;"></span>
                            <span ng-if="vm.Form.sensitivity.$error.required && vm.Form.sensitivity.$touched" class="help-block">{{'0016' | translate}}</span>
                          </div>
                        </div>


                        <div class="form-group form-group-sm">
                          <label class="col-md-3 text-right">
                            {{'0014' | translate}}:
                          </label>
                          <div class="col-md-5">
                            <toggle ng-model="vm.Detail.state" on="{{'0068' | translate}}" off="{{'0492' | translate}}"
                              ng-disabled="vm.isDisabledState" ng-change="vm.changeState()" size="btn-sm"></toggle>
                          </div>
                        </div>
                      </form>
                    </section>

                    <section id="section-2" style="padding: 5px 5px;height: 100%;">

                      <table class="table table-hover table-fixed">
                        <thead>
                          <tr>
                            <th class="col-md-5" style="width: 43%;">
                              {{ '0317' | translate }}
                            </th>
                            <th class="col-md-5" style="width: 48%;">
                              {{ '0288' | translate }}
                            </th>
                            <th class="col-md-1 text-right">
                              <i aria-hidden="true" class="fa fa-plus-circle" ng-if="vm.isDisabled"
                                style="font-size: 21px;top: 0px; color: #ada2a2;text-align: center;background-color: #eee;">
                              </i>
                              <i aria-hidden="true" class="fa fa-plus-circle green" ng-click="vm.Newrelation()" ng-if="!vm.isDisabled" style="font-size: 21px;top: 0px"></i>
                            </th>
                          </tr>
                        </thead>
                        <tbody class="contentscroll" id="bodysensitivity"  style="height: 326px;">
                          <tr data-ng-repeat="sensitivity in vm.sensitivities" ng-class="{'has-error': sensitivity.relationduplicate == true}">
                            <td class="col-md-1" style="display: none;">{{$index}}</td>
                            <td class="col-md-5">
                              <loadcombobox change="sensitivity.id=item.id;sensitivity.relationduplicate=false" cleanselect="false"
                                disabled="vm.isDisabled" listorigin="vm.listSensitivity"
                                ng-model="sensitivity.sensitivity.selected" placeholder="'items'"viewfieldcode="false">
                              </loadcombobox>
                              <span class="help-block" ng-if="sensitivity.relationduplicate">
                                {{vm.nameduplicate}}
                              </span>
                            </td>
                            <td class="col-md-6">
                              <loadcombobox change="sensitivity.test=item.id;sensitivity.relationduplicate=false" cleanselect="false"
                                disabled="vm.isDisabled" listorigin="vm.datatest"
                                ng-model="sensitivity.testcombo.selected" placeholder="'items'">
                              </loadcombobox>
                            </td>
                            <td class="col-md-1" ng-if="vm.sensitivities.length!= 1">
                              <i aria-hidden="true" class="fa fa-times-circle red" ng-if="vm.isDisabled"
                              style="font-size: 21px;top: 0px; color: #ada2a2;text-align: center;background-color: #eee;">
                              </i>
                              <i aria-hidden="true" class="fa fa-times-circle red" ng-click="vm.destroy($index)" ng-if="!vm.isDisabled" style="font-size: 21px;top: 0px"></i>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </section>
                  </div>
                </div>
              </div>
              <div class="panel-footer">
                <div class="container" style="width: 100%">
                  <button class=" btn btn-success button-list-five" ng-click="vm.New(vm.Form)"
                    ng-disabled="vm.isDisabledAdd" type="button">
                    <span aria-hidden="true" class="glyphicon glyphicon-plus">
                    </span>
                    {{'0005' | translate}}
                  </button>
                  <button class="btn btn-warning button-list-five" ng-click="vm.Edit()" ng-disabled="vm.isDisabledEdit"
                    type="button">
                    <span aria-hidden="true" class=" glyphicon glyphicon-pencil">
                    </span>
                    {{'0006' | translate}}
                  </button>
                  <button class="btn btn-primary button-list-five" ng-click="vm.save(vm.Form)"
                    ng-disabled="!vm.Form.$valid || vm.isDisabledSave" type="button">
                    <span aria-hidden="true" class="glyphicon glyphicon-floppy-disk">
                    </span>
                    {{'0007' | translate}}
                  </button>
                  <button class="btn btn-info button-list-five" ng-click="vm.cancel(vm.Form)"
                    ng-disabled="vm.isDisabledCancel" type="button">
                    <span aria-hidden="true" class="glyphicon glyphicon-remove">
                    </span>
                    {{'0008' | translate}}
                  </button>
                  <button class="btn btn-violet button-list-five" ng-click="vm.generateFile()"
                    ng-disabled="vm.isDisabledPrint" type="button">
                    <span aria-hidden="true" class="glyphicon glyphicon-print">
                    </span>
                    {{'0009' | translate}}
                  </button>
                  <csvtojson disabled="vm.isDisabledPrint" importdata="vm.importMicroorganism()"
                    json="vm.listmicroorganismos" quantitydata="vm.quantitydata">
                  </csvtojson>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<modalstate detailstate="vm.Detail.state" openstatemodal="vm.ShowPopupState"></modalstate>

<script id="sensitivity.html" type="text/ng-template">
  <div class="modal fade" data-keyboard="false" data-backdrop="static">
        <div class="modal-dialog modal-md">
            <div class="modal-content">
                <div class="modal-header modal-header-prymary">
                    <h4 class="modal-title" align="justify">
                        {{'0171' | translate}}
                    </h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12" style="display: flex;place-content: center;">
                          <div class="col-md-6">
                            <a ng-click="close('antibiogram')" class="thumbnail" data-dismiss="modal">
                              <img src="images/Antibiotic.png">
                              <h6 class="text-center"> {{'0317' | translate}}</h6>
                            </a>
                          </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</script>
